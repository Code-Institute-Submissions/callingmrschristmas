{% extends "base.html" %} {% load static %} {% load bootstrap_tags %}
{% load currency_tags %} {% block custom_scripts_js %}
<script src="https://js.stripe.com/v2"></script>
<script>
  //<![CDATA[
  Stripe.publishableKey = "{{ publishable }}";
  //]]
</script>
<script src="{% static 'js/stripe.js' %}"></script>
{% endblock %} {% block content %}
<div class="container bg-faded rounded">
  <div class="row row-flex">
    {% for item in cart_items %}

    <div
      class="col-xs-10 col-xs-offset-1 col-sm-offset-0 col-sm-6 col-md-4 display panel panel-display"
    >
      <div class="panel-body">
        <div
          class="service"
          style="background-image: url('static/img/service-images/{{ item.img }}')"
        ></div>

        <div class="caption">
          <h3>{{ item.title }}</h3>
          <p class="service-description">{{ item.description }}</p>
          <p>{{ item.quantity }}</p>
          <p>{% currency item.price %}</p>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  <div class="row text-center">
    <h5>Total: {% currency total %}</h5>
  </div>

  <form
    role="form"
    action="{% url 'checkout' %}"
    method="post"
    id="payment-form"
  >
    <legend>Payment Details</legend>
    <div id="credit-card-errors" style="display:none">
      <div
        class="alert-message blockmessage error"
        id="stripe-error-message"
      ></div>
    </div>
    <div class="form-group col-md-6">
      {{ order_form|as_bootstrap }}
    </div>
    <div class="form-group col-md-6">
      {{ payment_form|as_bootstrap }}
    </div>
    {% csrf_token %}
    <div class="form-group col-md-12">
      <input
        type="submit"
        name="commit"
        class="btn btn-primary"
        id="submit_payment_btn"
        value="Submit Payment"
      />
    </div>
  </form>
</div>
{% endblock %}
